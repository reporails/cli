rules:
  # Heuristic gate: detect review process indicators
  # Positive indicators (INFO) plus problem detector (WARNING)

  - id: M2-branch-protection
    message: "Branch protection configured"
    severity: INFO
    languages: [yaml]
    pattern-regex: "(?:CLAUDE\\.md|required_pull_request_reviews)"
    paths:
      include:
        - "**/.github/branch-protection.yml"
        - "**/.github/settings.yml"

  - id: M2-codeowners-claude
    message: "CODEOWNERS includes CLAUDE.md"
    severity: INFO
    languages: [generic]
    pattern-regex: "CLAUDE\\.md"
    paths:
      include:
        - "**/CODEOWNERS"
        - "**/.github/CODEOWNERS"

  - id: M2-direct-commit-indicator
    message: "Instruction file may have direct commits without review"
    severity: WARNING
    languages: [generic]
    # Detect instruction files that mention bypassing review
    pattern-regex: "(?i)(?:skip\\s+review|no\\s+review|direct\\s+commit|without\\s+(?:pr|review))"
    paths:
      include:
        - "**/CLAUDE.md"
        - "**/.claude/rules/*.md"
