# Regex patterns for capability detection
# CLI-owned configuration for content analysis (Phase 2)

rules:
  - id: capability.has-sections
    message: "Has markdown sections (H2+)"
    languages: [generic]
    severity: INFO
    pattern-regex: "^##+ "
    paths:
      include:
        - "*.md"
        - "**/CLAUDE.md"
        - "**/*.md"

  - id: capability.has-imports
    message: "Has @imports or file references"
    languages: [generic]
    severity: INFO
    pattern-either:
      - pattern-regex: "@import"
      - pattern-regex: "@docs/"
      - pattern-regex: "@\\.shared/"
      - pattern-regex: "Read `[^`]+`"
    paths:
      include:
        - "*.md"
        - "**/CLAUDE.md"
        - "**/*.md"

  - id: capability.has-explicit-constraints
    message: "Has explicit constraints (RFC 2119, structural, or marker)"
    languages: [generic]
    severity: INFO
    pattern-either:
      # Strong: RFC 2119 all-caps keywords
      - pattern-regex: "\\bMUST\\b"
      - pattern-regex: "\\bMUST NOT\\b"
      - pattern-regex: "\\bNEVER\\b"
      # Medium: list-item + constraint verb (structural context prevents false positives)
      - pattern-regex: "^- .*Never"
      - pattern-regex: "^- .*Avoid"
      - pattern-regex: "^- .*Always"
      - pattern-regex: "^- .*must"
      # Medium: explicit negation
      - pattern-regex: "Do NOT"
      - pattern-regex: "do NOT"
      # Medium: anti-pattern markers
      - pattern-regex: "‚ùå"
    paths:
      include:
        - "**/AGENTS.md"
        - "**/CLAUDE.md"

  - id: capability.has-path-scoped-rules
    message: "Has path-scoped rules (paths: in frontmatter)"
    languages: [generic]
    severity: INFO
    pattern-regex: "^paths:\\s*$"
    paths:
      include:
        - ".claude/rules/*.md"
        - ".ai/rules/*.md"
